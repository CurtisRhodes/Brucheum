<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - OggleBooble</title>
    <link rel='shortcut icon' href='Images/favicon.png' type='image/x-icon' />
    <script src="https://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <script src='https://code.jquery.com/ui/1.12.1/jquery-ui.min.js' type='text/javascript'></script>
    <link href='https://netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.css' rel='stylesheet' />
    <script src='https://netdna.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.js' type="text/javascript"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.12/summernote.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.12/summernote.js"></script>
    <script src="Scripts/Login.js"></script>
    <script src="Scripts/Common.js"></script>
    <script src="Scripts/OggleHeader.js"></script>
    <script src="Scripts/OggleFooter.js"></script>
    <script src="Scripts/HitCounter.js"></script>
    <script src="Scripts/DirTree.js"></script>
    <script src="Scripts/FolderCategoryDialog.js"></script>
    <script src="Scripts/ModelInfoDialog.js"></script>
    <script src="Scripts/ImageCommentDialog.js"></script>
    <script src="Scripts/MoveCopyArchive.js"></script>
    <script src="Scripts/MetaTagDialog.js"></script>

    <link href="Styles/jqueryUI.css" rel="stylesheet" />
    <link href="Styles/loginDialog.css" rel="stylesheet" />
    <link href="Styles/Header.css" rel="stylesheet" />
    <link href="Styles/Common.css" rel="stylesheet" />
    <link href="Styles/Carousel.css" rel="stylesheet" />
    <link href="Styles/ImagePage.css" rel="stylesheet" />
    <link href="Styles/MoveCopyArchiveDialog.css" rel="stylesheet" />
    <link href="Styles/ModelInfoDialog.css" rel="stylesheet" />
    <!--
    <link href="Styles/MetaTagDialog.css" rel="stylesheet" />
    <link href="Styles/ImageCommentDialog.css" rel="stylesheet" />
    <link href="Styles/ImageCategoryDialog.css" rel="stylesheet" />
    <link href="Styles/MetaTagDialog.css" rel="stylesheet" />
    -->
    <!--<script src="/signalr/hubs"></script>-->
    <!--<script src="Scripts/jquery.signalR-2.4.1.min.js"></script>-->
    <link href="Styles/Dashboard.css" rel="stylesheet" />
    <link href="Styles/ChooseBox.css" rel="stylesheet" />
    <script src="Scripts/Dashboard.js"></script>
    <script src="Scripts/Admin.js"></script>

</head>
<body>
    <header></header>
    <div class="threeColumnLayout">
        <div id="leftColumn"></div>
        <div id="middleColumn">
            <img id="dashBoardLoadingGif" class="loadingGif" src="Images/loader.gif" />

            <style>
                .metricsHeader {
                    background-color: var(--brucheumBlue);
                    color: #fff;
                    display: inline-flex;
                    width: 100%;
                }

                .metricsContainer {
                    border-left: solid 3px var(--oggleBorderColor);
                    border-right: solid 3px var(--oggleBorderColor);
                    border-bottom: solid 0.75px var(--oggleBorderColor);
                    background-color: var(--oggleContainerBackgroundColor);
                }
                .metricsCloseButton {
                    float: right;
                    padding-top: 15px;
                    padding-right:15px;
                    cursor: pointer;
                }
                .metricsHeaderLabel {
                     float:left; 
                     width:100%; 
                     text-align:center;
                     border: solid thin red;
                }

                .metricsRow1 {
                    margin-top:1px;
                    padding: 10px;
                }

            </style>
            
            <div id="divHitMetrics" class="metricsContainer displayHidden">
                <div class="metricsHeader">
                    <div class="metricsHeaderLabel" ><h3>Metrics</h3></div>
                    <div class="metricsCloseButton"><img style="height:25px" src="/images/poweroffRed01.png" onclick="closeMetrics()"></div>
                </div>
                <div class="metricsRow1">
                    <div id="metricsReport1"></div>
                </div>
                <div class="metricsRow2">

                </div>
                <div class="metricsRow3">

                </div>
            </div>

            <div id="divAddImages"  class="dashBoardContainer">
                <div class="leftColumnList">
                    <div class="clickable" onclick="buildDirectoryTree()">ReBuild Dir Tree</div>
                    <div class="clickable" onclick="$('#createNewFolderDialog').dialog('open');">Create New Folder</div>
                    <div class="clickable adminLevelRequired" onclick="showMoveFolderDialog();">Move Folder</div>
                    <div class="clickable adminLevelRequired" onclick="$('#renameFolderCrud').dialog('open');">Rename Folder</div>
                    <div class="clickable adminLevelRequired" onclick="loadProperties()">load Properties</div>
                    <div class="clickable adminLevelRequired" onclick="$('#createStaticPagesCrud').dialog('open');">Create Static Pages</div>
                    <div class="clickable adminLevelRequired" onclick="repairLinks()">Repair Links</div>
                    <div class="clickable adminLevelRequired" onclick="showAddRolesDialog()">Add/Edit Roles</div>
                    <div class="clickable adminLevelRequired" onclick="showAssignRolesDialog()">Assign User Roles</div>
                    <div class="clickable adminLevelRequired" onclick="prepareXhamsterPage()">Prepare xHamster Page</div>
                    <div class="clickable adminLevelRequired" onclick="showPerfMetrics()">Performance Metrics</div>
                </div>

                <div id="divWorkArea" class="workarea">
                    <div id="divStatusMessage"></div>

                    <div id="uploadArea" class="oggleh">
                        <div id="addNewLink" class="addLinkCrudArea">
                            <div>link&nbsp;&nbsp;<input id="txtNewLink" tabindex="1" class="roundedInput" onblur="previewLinkImage()" /></div>
                            <div>path&nbsp;<input class="roundedInput txtLinkPath" readonly="readonly" /></div>
                            <div class="roundendButton" tabindex="2" onclick="addImageLink()">Insert</div>
                        </div>
                        <img id="imgLinkPreview" class="linkImage" />
                    </div>

                    <div id="progressBar" class="dashboardProgessBar"></div>
                    <div id="dataifyInfo" class="infoLine"></div>
                </div>
                <div id="dirTreeContainer" class="treeContainer"></div>
                <img id="getDirTreeLoadingGif" class="smallLoadingGif" src="/Images/loader.gif" />
            </div>

            <div id="divModalDialogs">
                <div id="createNewFolderDialog" class="dashboardToggle" title="Create New Folder">
                    <div><span>title</span><input id="txtNewFolderTitle" class="roundedInput" /></div>
                    <div><span>parent</span><input class="txtLinkPath roundedInput" readonly="readonly" /></div>
                    <div class="roundendButton" onclick="createNewFolder()">Create Folder</div>
                </div>

                <div id="createStaticPagesCrud" class="dashboardToggle" title="Create Static Pages">
                    <div><span>folders to staticify</span><input id="txtFolderToStaticify" class="txtLinkPath roundedInput" readonly="readonly" /></div>
                    <div><span>include all subfolders </span><input type="checkbox" id="ckIncludeSubfolders" checked="checked" /></div>
                    <div class="roundendButton" onclick="createStaticPages($('#ckIncludeSubfolders').is(':checked'))">Build Files</div>
                    <div id="renameFolderReport" class="repairReport"></div>
                </div>

                <div id="renameFolderCrud" class="dashboardToggle" title="Rename Folder">
                    <div><span>folder to rename</span><input id="txtFolderToRename" class="txtLinkPath roundedInput" readonly="readonly" /></div>
                    <div><span>new name</span><input id="txtReName" class="roundedInput" /></div>
                    <div class="roundendButton" onclick="renameFolder()">Rename Folder</div>
                    <div id="renameFolderReport" class="repairReport"></div>
                </div>

                <div id="moveFolderCrud" class="dashboardToggle" title="Move Folder">
                    <div>
                        <span>new parent </span><div onclick="$('#partialViewTreeContainer').dialog('open');" class="toggleButton">...</div>
                        <input id="txtFolderToMove" class="txtPartialDirTreePath roundedInput" readonly="readonly" />
                    </div>
                    <div><span>move folder</span><input id="txtNewFolderParent" class="txtLinkPath roundedInput" readonly="readonly" /></div>
                    <div class="roundendButton" onclick="moveFolder()">Move Folder</div>
                </div>

                <div id="partialViewTreeContainer" title="Select Folder to move">
                    <div id="folderToMoveTreeContainer" class="moveDirTreeContainer"></div>
                </div>

                <div id="addEditRolesDialog" class="dashboardToggle" title="Add Edit Roles">
                    <div class="crudArea">
                        <label>Role:</label>
                        <input class="roundedInput" id="txtRoleName" />
                        <div id="btnAddUpdateRole" class="roundendButton editRolebtn" onclick="addUpdateRole()">Add</div>
                        <div id="btnRoleToggle" class="roundendButton editRolebtn" onclick="toggleAddButton()">New</div>
                    </div>
                    <div class="crudItemsList" id="divRoleList"></div>
                </div>

                <div id="rolesChooseBoxDialog" class="dashboardToggle" title="Assign Roles">
                    <div class="crudContainer AssignRolesContainer">
                        <div class="crudContainerTitle">Assign Roles</div>
                        <div class="flexContainer">
                            <div><select id="ddUsers" class="crudDropDown"></select></div>
                        </div>
                        <div id="divRolesChoose" class="chooseBoxContainer">

                            <div id="divChooseAvailable" class="chooseBox floatLeft"></div>

                            <div id="divChooseButtons" class="chooseBtnsContainer floatLeft">
                                <div><img id="imgAdd" class="chooseBtn" onclick="addUserRole()" src="/Images/sglright.jpg" /></div>
                                <div><img id="imgAddAll" class="chooseBtn disenabled" src="/Images/dblright.jpg" /></div>
                                <div><img id="imgRemove" class="chooseBtn" onclick="removeUserRole()" src="/Images/sglleft.jpg" /></div>
                                <div><img id="imgRemoveAll" class="chooseBtn disenabled" src="/Images/dblleft.jpg" /></div>
                            </div>
                            <div id="divChooseAssigned" class="chooseBox floatLeft"></div>
                        </div>
                    </div>
                </div>

                <!--
                    <div id="videoCrud" class="dashboardToggle">
                        <div class="floatingCrudBanner">Add Video Link <div onclick="$('#videoCrud').fadeOut()" class="farSide">x</div> </div>
                        <div class="floatingCrudContainer">
                            <div><span class="cru">link</span><input id="txtVideoLink" class="roundedInput" /></div>
                            <div><span>image</span><input id="txtVideoImage" class="roundedInput" /></div>
                            <div><span>title</span><input id="txtVideoTitle" class="roundedInput" /></div>
                            <div class="roundendButton" onclick="addVideo()">Insert</div>
                        </div>
                    </div>
                -->
            </div>
            <div id="rightColumn"></div>
        </div>
        <div id="dashboardContextMenu" class="ogContextMenu" onmouseleave="$(this).fadeOut();">
            <div onclick="dashboardContextMenuOpenFolder()">Open Folder</div>
            <div onclick="dashboardContextMenuShowCategoryDetails()">Show Category Info</div>
            <div onclick="dashboardContextMenuShowInfoDialog()">Show Model Info</div>
        </div>
    </div>
    <!--<div w3-include-html="Snippets/BoobsFooter.html"></div>-->
    <div w3-include-html="Snippets/AdminDialogs.html"></div>
    <div w3-include-html="Snippets/Login.html"></div>
    <div w3-include-html="Snippets/Register.html"></div>

    <script>
        $(document).ready(function () {
            includeHTML();

            //var dots = "";
            loadSettings();
            var waiter = setInterval(function () {
                if (settingsArray.ApiServer === undefined) {
                    //dots += ". ";
                    //$('#text55').html(dots);
                }
                else {
                    clearInterval(waiter);
                    setOggleHeader("admin");
                    buildDirectoryTree();
                    setUserPermissions();
                    logSpecialPageHit("Dashboard");
                }
            }, 300);

            defineDilogs();
            //setSignalR();
            window.addEventListener("resize", resizeDashboardPage);
            resizeDashboardPage();
        });

        function setSignalR() {

            var connection = $.hubConnection(service);

            var progressHubProxy = connection.createHubProxy('ProgressHub');

            progressHubProxy.on('PostToClient', function (data) {
                $('#dataifyInfo').html(data);
            });

            progressHubProxy.on('ShowProgressBar', function (goal, progress) {
                $('#progressBar').progressbar({ value: progress, max: goal });
            });


            connection.start({ jsonp: true })
                .done(function () {
                    console.log('Now connected, connection ID=' + connection.id);
                })
                .fail(function () {
                    alert('signalr Could not connect');
                    console.log('signalr Could not connect');
                });
        }

        function defineDilogs() {
            $('#uploadArea').keydown(function (event) {
                if (event.keyCode === 13) {
                    // Cancel the default action, if needed
                    // Trigger the button element with a click
                    addImageLink();
                }
            });

            $('#moveFolderCrud').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                width: "400"
            });
            $('#renameFolderCrud').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                width: "400"
            });
            $('#createNewFolderDialog').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                width: "615"
            });
            $('#createNewFolderDialog').keydown(function (event) {
                if (event.keyCode === 13) {
                    createNewFolder();
                }
            });

            $('#createStaticPagesCrud').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                width: "400"
            });

            $('#moveFolderCrud').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                width: "400"
            });

            $('#partialViewTreeContainer').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                position: ({ my: 'right', at: 'left', of: $('#moveFolderCrud') }),
                width: "400",
                height: "550"
            });

            $('#rolesChooseBoxDialog').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                width: "700"
            });

            $('#addEditRolesDialog').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                width: "400"
            });
        }

    </script>
</body>
</html>
