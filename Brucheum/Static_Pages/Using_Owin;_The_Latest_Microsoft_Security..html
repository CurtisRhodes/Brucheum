<!DOCTYPE html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using Owin; The Latest Microsoft Security. - The Brucheum</title>
    <link href="/Styles/default.css" rel="stylesheet">
    <script id="facebook-jssdk" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v3.0"></script><script src="https://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <script src="/Scripts/GlobalFunctions.js"></script>
    <script src="/Scripts/ResizeThreeColumnPage.js"></script>
<style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_dialog_advanced{border-radius:8px;padding:10px}.fb_dialog_content{background:#fff;color:#373737}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{left:5px;right:auto;top:5px}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{height:100%;left:0;margin:0;overflow:visible;position:absolute;top:-10000px;transform:none;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{background:none;height:auto;min-height:initial;min-width:initial;width:auto}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{clear:both;color:#fff;display:block;font-size:18px;padding-top:20px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .4);bottom:0;left:0;min-height:100%;position:absolute;right:0;top:0;width:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_mobile .fb_dialog_iframe{position:sticky;top:0}.fb_dialog_content .dialog_header{background:linear-gradient(from(#738aba), to(#2c4987));border-bottom:1px solid;border-color:#1d3c78;box-shadow:white 0 1px 1px -1px inset;color:#fff;font:bold 14px Helvetica, sans-serif;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:linear-gradient(from(#4267B2), to(#2a4887));background-clip:padding-box;border:1px solid #29487d;border-radius:3px;display:inline-block;line-height:18px;margin-top:3px;max-width:85px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{background:none;border:none;color:#fff;font:bold 12px Helvetica, sans-serif;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #4a4a4a;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f5f6f7;border:1px solid #4a4a4a;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-position:50% 50%;background-repeat:no-repeat;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}
.fb_customer_chat_bounce_in_v2{animation-duration:300ms;animation-name:fb_bounce_in_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_v2{animation-duration:300ms;animation-name:fb_bounce_out_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_in_v2_mobile_chat_started{animation-duration:300ms;animation-name:fb_bounce_in_v2_mobile_chat_started;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_v2_mobile_chat_started{animation-duration:300ms;animation-name:fb_bounce_out_v2_mobile_chat_started;transition-timing-function:ease-in}.fb_customer_chat_bubble_pop_in{animation-duration:250ms;animation-name:fb_customer_chat_bubble_bounce_in_animation}.fb_customer_chat_bubble_animated_no_badge{box-shadow:0 3px 12px rgba(0, 0, 0, .15);transition:box-shadow 150ms linear}.fb_customer_chat_bubble_animated_no_badge:hover{box-shadow:0 5px 24px rgba(0, 0, 0, .3)}.fb_customer_chat_bubble_animated_with_badge{box-shadow:-5px 4px 14px rgba(0, 0, 0, .15);transition:box-shadow 150ms linear}.fb_customer_chat_bubble_animated_with_badge:hover{box-shadow:-5px 8px 24px rgba(0, 0, 0, .2)}.fb_invisible_flow{display:inherit;height:0;overflow-x:hidden;width:0}.fb_mobile_overlay_active{background-color:#fff;height:100%;overflow:hidden;position:fixed;visibility:hidden;width:100%}@keyframes fb_bounce_in_v2{0%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}50%{transform:scale(1.03, 1.03);transform-origin:bottom right}100%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}}@keyframes fb_bounce_in_v2_mobile_chat_started{0%{opacity:0;top:20px}100%{opacity:1;top:0}}@keyframes fb_bounce_out_v2{0%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}100%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}}@keyframes fb_bounce_out_v2_mobile_chat_started{0%{opacity:1;top:0}100%{opacity:0;top:20px}}@keyframes fb_customer_chat_bubble_bounce_in_animation{0%{bottom:6pt;opacity:0;transform:scale(0, 0);transform-origin:center}70%{bottom:18pt;opacity:1;transform:scale(1.2, 1.2)}100%{transform:scale(1, 1)}}</style><meta name="Title" content="Using Owin; The Latest Microsoft Security." property="og:title"><meta content="website" property="og:type"><meta content="http://curtisrhodes.com/app_data/images/L5OsJPQcyvrb.jpg" property="og:image"><br><meta content="https://Curtisrhodes.com/static_pages/Using_Owin;_The_Latest_Microsoft_Security..html" property="og:url"></head>
<body>
    <link href="/Styles/bHeader.css" rel="stylesheet">
<div class="Header" id="bheader">
    <div class="floatLeft">
        <a href="/Home/Index"><img class="bannerImage" src="/images/house.gif"></a>
    </div>
    <div class="headerBody" style="width: 1584px;">
        <div class="headerBannerTitle" id="bannerTitle">
            Curtis Rhodes.com
        </div>
        <div class="menuTabContainer">
            <div class="menuTab"><a href="/Article/ArticleList">Latest Articles</a></div>
            <div class="menuTab"><a href="/Article/ArticleList?filterType=Category&amp;filter=political rant">Political Rants</a></div>
            <div class="menuTab"><a href="/Article/ArticleList?filterType=Category&amp;filter=conspiracy">Conspiracy Theories</a></div>
            <div class="menuTab"><a href="/Book/MyBooks">Books</a></div>
            <div class="menuTab"><a href="/Home/Apps">Apps</a></div>
            <div class="menuTab"><a href="/Consulting/ConsultingHome">Intelligent Design</a></div>
                <div class="menuTab"><a href="/Admin">Admin</a></div>

        </div>
        <div class="loginTab">
            

                            <div title="modify profile" class="menuTab" id="tabProfile">
                    <a href="#">Hello Admin </a>
                </div>
                <div class="menuTab" id="tabLogout"><a href="javascript:sessionStorage.removeItem('accessToken');$('#logoutForm').submit();">Log Out</a></div>
        </div>
    </div>
    <div class="noFloat"></div>
</div>

<script>

    $(document).ready(function () {

        $('.headerBody').width($('.Header').width() - $('#bannerImage').width() - 200);
    });
    $(window).resize(function () {
        $('.headerBody').width($('.Header').width() - $('#bannerImage').width() - 200);
    });

    $('#tabRegister').click(function () {
        $.ajax({
            type: "get",
            url: "/Login/Register",
            datatype: "json",
            success: function (data) {
                $('#modalContent').html(data);
                $('#modalContainer').show();
            },
            error: function (xhr) {
                alert("RegisterPopup error: " + xhr.statusText);
            }
        });
    });

    $('#tabLogIn').click(function () {
        $.ajax({
            type: "get",
            url: "/Login/Login",
            datatype: "json",
            success: function (data) {
                $('#modalContent').html(data);
                $('#modalContainer').show();
            },
            error: function (xhr) {
                alert("LoginPopup error: " + xhr.statusText);
            }
        });
    });

    $('#tabProfile').click(function () {
        try {
            $.ajax({
                type: "get",
                url: "/Login/ProfilePopup",
                datatype: "json",
                success: function (data) {
                    $('#modalContent').html(data);
                    $('#modalContainer').show();
                },
                error: function (xhr) {
                    alert("ProfilePopup error: " + xhr.statusText);
                }
            });
        } catch (e) {
            alert("tabProfile catch: " + catchErrorDetails(e));
        }
    });

    $('#tabLogout').click(function () {
        $.ajax({
            type: "POST",
            url: "/Login/Logout",
            success: function (success) {
                if (success === "ok")
                    //$("#divlogin").load(location.href + " #divlogin");
                    location.reload(true);
                else
                    alert("LogOUT: " + success);
            },
            error: function (xhr) {
                displayStatusMessage("alert-danger", "error: " + xhr.statusText);
                alert("tabLogout error: " + xhr.statusText);
            }
        });
    });
</script>
    <div class="body-content">
        

<!-- Load Facebook SDK for JavaScript -->
<div class=" fb_reset" id="fb-root"><div style="top: -10000px; width: 0px; height: 0px; position: absolute;"><div></div></div><div style="top: -10000px; width: 0px; height: 0px; position: absolute;"><div><iframe name="fb_xdm_frame_https" tabindex="-1" title="Facebook Cross Domain Communication Frame" id="fb_xdm_frame_https" aria-hidden="true" src="https://staticxx.facebook.com/connect/xd_arbiter/r/__Bz3h5RzMx.js?version=42#channel=f24c26139a3a958&amp;origin=http%3A%2F%2Flocalhost%3A57430" frameborder="0" scrolling="no" allowfullscreen="true" style="border: medium; border-image: none;" allowtransparency="true" allow="encrypted-media"></iframe></div></div></div>
<script>
    (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>

<script src="/Scripts/ImageTools.js"></script>
<link href="/Styles/article.css" rel="stylesheet">

<div class="threeColumnArray" style="height: 1233px;">
    <div id="leftColumn">
        <div id="shareToFacebook"><div class="fb-share-button" data-mobile-iframe="false" data-size="large" data-layout="button" data-href="https://Curtisrhodes.com/static_pages/Using_Owin;_The_Latest_Microsoft_Security..html"><a href="https://www.facebook.com/sharer/sharer.php?u=https://Curtisrhodes.com/static_pages/Using_Owin;_The_Latest_Microsoft_Security..html&amp;src=sdkpreparse" target="_blank">Share on Facebook</a></div></div>
    </div>
    <div id="middleColumn" style="width: 1534px;">
            <div id="divStatusMessage"></div>
            <div id="pollybox">
                <div id="divTopLine">
                    10/25/2018
                    <div class="floatRightDiv">
                        
                    </div>
                </div>
                <div id="divTitle">Using Owin; The Latest Microsoft Security.</div>

                <div id="divByline">
                    by: me
                    <div class="floatRightDivEdit">
                        <a href="ArticleEdit?Id=18f1f6f7-6491-4b96-9a4c-d48058455efd">edit</a>
                    </div>
                </div>
            </div>
            <div id="divImage"><img id="articleImage" src="https://api.curtisrhodes.com/App_Data/Images/L5OsJPQcyvrb.jpg"></div>
            <div id="divSummary">Understand that this website is a place for me to try new things and report on them and add them to my list of skills. For years the Microsoft Security system has been a black box for me. I've used the default configuration that comes "out of the box" when you use a template to create a new project, but I hate not knowing what's going on on my own site. I prefer to just build my own login and register screens and use my own database tables. I already had a security system up and working fine, but I was looking at some .net Core templates and see how they all use Owin microservices. I decided I had to have the latest stuff. </div>
            <div id="divContent">It took a few days.   just spent another entire day still trying to figure out Microsoft Security. It's not enough to get it running, I want to understand what it's doing.<br> Last time I checked my Service Provider (GoDaddy) doesn't support the .net framework needed for Core so I last upgraded my site it was to Framework 4.7 which is for Asp.net.      The thing about the Microsoft Authentication, the start up sequence, when the session becomes active, the authorization this and the     that was a great waste of time. I already had it working I just thought and then they put it all in a black box, encapsulated in a library. I can't stand it when I don't understand what it's doing. There's OAuth. Then there's the IAppBuilder configure. There's cookies and TwoFactorSignIn cookies, and external signIn cookies.  <br>First let's talk about the ApplicationUserManager and the ApplicationSignInManager. <p>  There' an old joke about how some people are happy when they turn the key on the dashboard back when cars used keys  </p> <p> </p> You know what ASP stands for: "Active Server Pages"  <p>  I finally got my email working or at least I thought I did. didn't work here. I am going to change the database to include the app as well as the ip address. No that it really matters. Then I tried to use the AspNetUsers table as a normal file and add some more fields like FirstName Last and the usual. Well that triggered an error and so I tried to figure out why. </p><p>Somehow I ended up screwing things up, went into Dll Hell, and lost another day.</p></div>
            <div class="roundendButton" id="divCommentsButton">comments</div>
            <div id="divCommentsSection">
                 = (string)https://api.curtisrhodes.com;
                
<style>
    /*Comments*/

    #divCommentsBody {
        width: 100%;
        border: 2px solid #000;
        padding: 4px;
        margin-bottom: 6px;
    }

    #divKnownUser {
        border: solid thin #ebe9e9;
        padding: 6px;
    }

    #divLoginWarning {
        border: solid thin red;
        padding: 6px;
        text-align: center;
    }

        #divLoginWarning span {
            color: #2e7fd8;
            text-decoration: underline;
        }

    #commentEntry {
        border: solid thin #5c5151;
        margin: 4px;
        width: 100%;
    }

    #textAreaComment {
        background-color: #ebe9e9;
        width: 96%;
        min-height: 200px;
        padding: 4px;
        margin-bottom: 6px;
    }

    #imgPowerOffRed {
        height: 24px;
        padding-top: 14px;
        margin-left: 22px;
    }

    .crud {
        font-size: 18px;
    }

        .crud input {
            display: inline-block;
            width: 80%;
            margin: 4px;
        }

    .cHistoryRow {
        display: flex;
        padding: 4px;
        background-color: #d7e57c;
        margin-bottom: 3px;
    }

    .cHistoryCol {
        float: left;
        padding: 2px 3px 2px 7px;

</style>


    <div id="divCommentsBody">
        <div id="divLoginWarning" style="display: none;">You must <span class="clickable" id="spRegister">Register</span> or <span class="clickable" id="spLogin">Login</span> to comment</div>
        <div id="divKnownUser">Hello Admin</div>
        <div id="commentEntry">
            <div class="crud">
                <span>Title: </span><input class="roundedInput" id="txtTitle">
                <img id="imgPowerOffRed" src="/Images/powerOffRed01.png">
                <textarea id="textAreaComment"></textarea>
            </div>
            <div id="divButtons">
                <button class="roundendButton" id="btnSubmitComment">Submit</button>
            </div>
        </div>
        <div id="commentHistory"><div class="cHistoryRow"><div class="cHistoryCol">0001-01-01</div><div class="cHistoryCol">null</div><div class="cHistoryCol">null</div><div class="cHistoryCol">null</div></div></div>
    </div>

    <script>

    $(document).ready(function () {
            $('#divKnownUser').html("Hello " + 'Admin');
            $('#divKnownUser').show();
            $('#divLoginWarning').hide();
        getCommentHistory();

    });

    $('#spLogin').click(function () {
        $.ajax({
            type: "get",
            url: "/Login/Login",
            datatype: "json",
            success: function (data) {
                $('#modalContent').html(data);
                $('#modalContainer').show();
            },
            error: function (xhr) {
                alert("RegisterPopup error: " + xhr.statusText);
            }
        });
    });

    $('#spRegister').click(function () {
        $.ajax({
            type: "get",
            url: "/Login/Register",
            datatype: "json",
            success: function (data) {
                $('#modalContent').html(data);
                $('#modalContainer').show();
            },
            error: function (xhr) {
                alert("RegisterPopup error: " + xhr.statusText);
            }
        });
    });


    $('#btnSubmitComment').click(function () {
        var comment = new Object();
        comment.CommentTitle = $('#txtTitle').val();
        comment.CommentText = $('#textAreaComment').val();
        comment.CommentId = $('#hiddenId').val();
        comment.UserId = userId;
        comment.ArticleId = articleId;

        if ($('#btnSubmitComment').text() === "Submit") {
            SaveComment(comment);
        }
        else {
            UpdateComment(comment);
        }
    });

    function getCommentHistory() {
        try {
            //$('#divLoadingGif').show();
            $.ajax({
                url: service + "/api/Comments/get/?articleId=" + articleId,
                type: "get",
                dataType: "Json",
                success: function (result) {
                    if (result.length !== 0) {
                        $('#commentHistory').html("");
                        $.each(result, function (idx, comment) {
                            $('#commentHistory').append("<div class='cHistoryRow'>" +
                                "<div class='cHistoryCol'>" + comment.CreateDate.substr(0, comment.CreateDate.indexOf("T")) + "</div>" +
                                "<div class='cHistoryCol'>" + comment.UserName + "</div>" +
                                "<div class='cHistoryCol'>" + comment.CommentTitle + "</div>" +
                                "<div class='cHistoryCol'>" + comment.CommentText + "</div>" +
                                "</div>");
                        });
                    }

                    var tcH = $('.threeColumnArray').height();
                    $('.threeColumnArray').height(tcH + $('#divCommentsSection').height());
                    resizePage();
                },
                error: function (xhr) {
                    alert("saveAs error: " + xhr.statusText);
                }
            });
        } catch (e) {
            alert("getComments: " + catchErrorDetails(e));
            displayStatusMessage("alert-danger", "catch ERROR: " + catchErrorDetails(e));
        }
    }

    function SaveComment(comment) {
        $.ajax({
            url: service + "//api//Comments//Post",
            type: "post",
            dataType: "Json",
            data: comment,
            success: function (success) {
                if (!success.startsWith("ERROR")) {
                    $('#hiddenId').val(success);
                    $('#btnSubmitComment').text("Update");
                    getComments();
                }
                else {
                    displayStatusMessage("alert-danger", "xhr ERROR: " + result.Success);
                    alert(success);
                }
            },
            error: function (xhr) {
                alert("save Comment error: " + xhr.statusText);
            }
        });
    }

    function UpdateComment(comment) {
        $.ajax({
            url: service + "/api/Comments/Put",
            type: "put",
            dataType: "Json",
            data: comment,
            success: function (success) {
                if (!success.startsWith("ERROR")) {
                    //$('#hiddenId').val(success);
                    //$('#btnSubmit').val("Update");
                    getComments();
                }
                else {
                    displayStatusMessage("alert-danger", "xhr ERROR: " + result.Success);
                }
            },
            error: function (xhr) {
                alert("Update Comments error: " + xhr.statusText);
            }
        });
    };

    $('#imgPowerOffRed').click(function () {
        $('#divCommentsSection').hide();
    });

    </script>
            </div>
        <input id="hiddenId" type="hidden">
    </div>
    <div id="rightColumn">
        <div id="divTagList"></div>
    </div>
</div>

<script>
        var service = 'https://api.curtisrhodes.com';
        var tags = 'got to have one';
        var articleId = '18f1f6f7-6491-4b96-9a4c-d48058455efd'
        var imageName = 'L5OsJPQcyvrb.jpg';
        var content = 'It took a few days.   just spent another entire day still trying to figure out Microsoft Security. It&#39;s not enough to get it running, I want to understand what it&#39;s doing.&lt;br&gt; Last time I checked my Service Provider (GoDaddy) doesn&#39;t support the .net framework needed for Core so I last upgraded my site it was to Framework 4.7 which is for Asp.net.      The thing about the Microsoft Authentication, the start up sequence, when the session becomes active, the authorization this and the     that was a great waste of time. I already had it working I just thought and then they put it all in a black box, encapsulated in a library. I can&#39;t stand it when I don&#39;t understand what it&#39;s doing. There&#39;s OAuth. Then there&#39;s the IAppBuilder configure. There&#39;s cookies and TwoFactorSignIn cookies, and external signIn cookies.  &lt;br&gt;First let&#39;s talk about the ApplicationUserManager and the ApplicationSignInManager. &lt;p&gt;  There&#39; an old joke about how some people are happy when they turn the key on the dashboard back when cars used keys  &lt;/p&gt; &lt;p&gt; &lt;/p&gt; You know what ASP stands for: &quot;Active Server Pages&quot;  &lt;p&gt;  I finally got my email working or at least I thought I did. didn&#39;t work here. I am going to change the database to include the app as well as the ip address. No that it really matters. Then I tried to use the AspNetUsers table as a normal file and add some more fields like FirstName Last and the usual. Well that triggered an error and so I tried to figure out why. &lt;/p&gt;&lt;p&gt;Somehow I ended up screwing things up, went into Dll Hell, and lost another day.&lt;/p&gt;';
        var summary = 'Understand that this website is a place for me to try new things and report on them and add them to my list of skills. For years the Microsoft Security system has been a black box for me. I&#39;ve used the default configuration that comes &quot;out of the box&quot; when you use a template to create a new project, but I hate not knowing what&#39;s going on on my own site. I prefer to just build my own login and register screens and use my own database tables. I already had a security system up and working fine, but I was looking at some .net Core templates and see how they all use Owin microservices. I decided I had to have the latest stuff. ';
        var title = 'Using Owin; The Latest Microsoft Security.';
        var userId = '';
        var userName = '';
        var filePath = '';

        $(document).ready(function () {
            try {
                if (imageName !== "") {
                    $('#articleImage').attr("src", service + "/App_Data/Images/" + imageName);
                }
                content = beautify(content);
                $('#divContent').html(content);

                //stickCommentsButton();
            }
            catch (e) {
                alert("$(document).ready ERROR: " + catchErrorDetails(e));
            }
        });

        function stickCommentsButton() {
            var x = $('#divContent').position();
            var contentBottom = $('#divContent').position().top + $('#divContent').height() + $('.Header').height();
            var pageBottom = $('.threeColumnArray').height();

            if (pageBottom < contentBottom) {
                //alert("pageBottom: " + pageBottom + "  contentBottom: " + contentBottom);
                $('#divCommentsButton').css("position", "absolute").css("bottom", 0);
                $('#divCommentsButton').width($('#middleColumn').width());
                $('#divCommentsSection').css("position", "absolute").css("top", $('#divCommentsButton').position().top + 50);
                $('#divCommentsSection').width($('#middleColumn').width());
            }
            }

        // Show Comments
        $('#divCommentsButton').click(function () {
            //$('#divCommentsSection').toggle();
            if ($('#divCommentsSection').css("display") == "none") {
                $('#divCommentsSection').show();
            }
            else {
                $('#divCommentsSection').hide();
            }
        });

        $('#btnStaticify').click(function () {
            saveAsStaticFile();
        })

        function saveAsStaticFile() {
            if (imageName === "") {
                displayStatusMessage("alert-warning", "insuficent data. Image required");
                return;
            }
            $('head').append('<meta name="Title" content="' + title + '" property="og:title">');
            //$('head').append('<meta property="og:description" content="' + beautify(summary.substr(0, 300)) + '" />');
            $('head').append('<meta name="Keywords" content="' + beautify(tags.split(",").toString()) + '>');
            $('head').append('<meta property="og:type" content="website">');

            $('head').append("<meta property='og:image' content='http://curtisrhodes.com/app_data/images/" + imageName + "'>");
            //$('head').append("<meta property='og:image' content='data:image/gif;base64," + getImage(service, imageName) + "'>");

            var pageName = "https://Curtisrhodes.com/static_pages/" + title.replace(/ /g, "_") + ".html";
            $('head').append('<br/><meta property="og:url" content="' + pageName + '">');

                //< !--Your share button code-- >
                //<div class="fb-share-button"
                //    data-href="https://www.your-domain.com/your-page.html"
                //    data-layout="button_count">
                //</div>

            //$('#shareToFacebook').html('<div class="fb-share-button" data-href="https://developers.facebook.com/docs/plugins/" ' +
            //    'data-layout="button" data-size="large" data-mobile-iframe="false">' +
            //    '<a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&amp;src=sdkpreparse"' +
            //    ' class="fb-xfbml-parse-ignore">Share</a></div>');



            //$('#shareToFacebook').html('<div class="fb-share-button" data-href="' + pageName +'" data-layout="button" data-size="large" data-mobile-iframe="false">'+
            //'Share on Facebook</div>');

            $('#shareToFacebook').html('<div class="fb-share-button" data-href="' + pageName + '" data-layout="button" data-size="large" data-mobile-iframe="false">' +
                '<a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=' + pageName + '&src=sdkpreparse">Share on Facebook</a></div>');

            //var html = $('html').html();
            var data = new Object();
            data.html = "<!DOCTYPE html>" + $('html').html();
            try {
                $.ajax({
                    type: "POST",
                    url: "CreateStaticFile",

                    data: JSON.stringify(data),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    //processData: false,
                    //contentType: false,
                    //async: false,
                    //cache: false,
                    //data: data,
                    success: function (success) {
                        if (success === "ok") {
                            $('#btnStaticify').val("permalink");
                            $('#shareToFacebook').html('<button id="btnPermalink" class="roundendButton">permalink</button>');

                            $('#btnPermalink').click(function () {
                                window.location.href = "/static_pages/" + title.replace(/ /g, "_") + ".html", "target='_blank'";
                            })

                        }
                        else
                            alert("/api//File returned: " + success);
                    },
                    error: function (jqXHR, exception) {
                        alert("/api//File error: " + getXHRErrorDetails(jqXHR, exception));
                    }
                });
            }
            catch (e) {
                //alert("/api//File catch: " + e);
                alert("/api//File catch: " + catchErrorDetails(e));
            }
        }

        $(window).unload(function () {
            //$(this)
            alert("page move");
        });

    ///////////////////////////////////////////////////

    $('#btnTest').click(function () {
        location.href = "/Home/get_image?w=" + imageName;
    });
    $('#btnSpinnerTest').click(function () {
        $(this).append("<img src='/Images/loader.gif' class='tinyLoader' >");
    });
    $('#btnSpinnerTest').dblclick(function () {
        $(this).html("Add");
    });
</script>

    </div>
    <link href="/Styles/bFooter.css" rel="stylesheet">
<div class="Footer" id="footer">
    <div class="footerCol">
        <div><a href="/Home/Index">Articles</a></div>
        <div><a href="/Book/MyBooks">Books</a></div>
        <div><a href="/Consulting/ConsultingHome">Professional</a></div>
        <div><a href="#">Apps</a></div>
    </div>
    <div class="footerCol">
        <div><a href="#">About us</a></div>
        <div><a href="mailto:curtishrhodes@hotmail.com">Love Letters</a></div>
        <div><a href="mailto:curtis,rhodes@gmail.com">Death Threats</a></div>
        <div><a href="#">Archive</a></div>
    </div>
    <div class="footerCol">
        <div><a href="#">Site Map</a></div>
        <div><a href="#">Search</a></div>
        <div><a href="#">Research</a></div>
        <div><a href="#">Advertize</a></div>
    </div>
    <div id="copyright">
        ? 2018 - <a href="/Consulting/ConsultingHome">Intelligent Design SoftWare</a>
    </div>
</div>

<div id="fb-root"></div>

    <div class="modalVail" id="modalContainer">
        <div id="modalContent"></div>
    </div>
    
    <script>resizePage();</script>


</body>; border-image: none;" allowtransparency="true" allow="encrypted-media"></iframe></div></div></div>

    <div class="modalVail" id="modalContainer">
        <div id="modalContent"></div>
    </div>
    
    <script>resizePage();</script>


</body>