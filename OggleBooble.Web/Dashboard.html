<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - OggleBooble</title>
    <link rel='shortcut icon' href='Images/favicon.png' type='image/x-icon' />
    <script src="https://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <script src='https://code.jquery.com/ui/1.12.1/jquery-ui.min.js' type='text/javascript'></script>
    <!--<link href='https://netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.css' rel='stylesheet' />
    <script src='https://netdna.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.js' type="text/javascript"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.12/summernote.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.12/summernote.js"></script>-->
    <script src="Scripts/Common.js"></script>
    <script src="Scripts/DirTree.js"></script>
    <script src="Scripts/HitCounter.js"></script>
    <script src="Scripts/EventControl.js"></script>
    <script src="Scripts/OggleEventLog.js"></script>
    <script src="Scripts/Cookies.js"></script>
    <script src="Scripts/Login.js"></script>
    <script src="Scripts/OggleHeader.js"></script>
    <script src="Scripts/OggleSearch.js"></script>
    <script src="Scripts/OggleFooter.js"></script>
    <script src="Scripts/Permissions.js"></script>
    <script src="Scripts/FolderInfoDialog.js"></script>
    <script src="Scripts/ModelInfoDialog.js"></script>
    <script src="Scripts/ImageCommentDialog.js"></script>
    <script src="Scripts/MoveCopyArchive.js"></script>
    <script src="Scripts/MetaTagDialog.js"></script>
    <script src="Scripts/Dashboard.js"></script>
    <script src="Scripts/Roles.js"></script>
    <script src="Scripts/Reports.js"></script>

    <link href="Styles/jqueryUI.css" rel="stylesheet" />
    <link href="Styles/loginDialog.css" rel="stylesheet" />
    <link href="Styles/Header.css" rel="stylesheet" />
    <link href="Styles/Common.css" rel="stylesheet" />
    <link href="Styles/Carousel.css" rel="stylesheet" />
    <link href="Styles/MoveCopyArchiveDialog.css" rel="stylesheet" />
    <link href="Styles/ModelInfoDialog.css" rel="stylesheet" />
    <!--
    <link href="Styles/ImagePage.css" rel="stylesheet" />
    <link href="Styles/MetaTagDialog.css" rel="stylesheet" />
    <link href="Styles/ImageCommentDialog.css" rel="stylesheet" />
    <link href="Styles/ImageCategoryDialog.css" rel="stylesheet" />
    <link href="Styles/MetaTagDialog.css" rel="stylesheet" />
    -->
    <!--<script src="/signalr/hubs"></script>-->
    <!--<script src="Scripts/jquery.signalR-2.4.1.min.js"></script>-->
    <link href="Styles/Dashboard.css" rel="stylesheet" />
    <link href="Styles/ChooseBox.css" rel="stylesheet" />

</head>
<body>
    <header class="boobsHeader"></header>
        <img id="dashBoardLoadingGif" class="loadingGif displayHidden" src="Images/loader.gif" />
        <div id="dots"></div>
        <div id="divStatusMessage"></div>
        <div id="dashboardContainer" class="dashboardContainer">
            <div id="dashboardLeftColumn" class="dashboardContainerColumn">
                <div id="dashboardLeftMenu" class="oggleVerticalMenu"></div>
            </div>
            <div id="dashboardMiddleColumn" class="dashboardContainerColumn">
                <div id="workAreaContainer" class="workAreaContainer"></div>
                <div id="dataifyInfo" class="infoLine" onclick="$('#dataifyInfo').hide();"></div>
            </div>
            <div id="dashboardRightColumn" class="dashboardContainerColumn"></div>
        </div>
        <div id="divModalDialogs">
            


            <div id="moveFolderCrud" class="dashboardToggle" title="Move Folder">
                <div><span>folder to move</span><input id="txtNewFolderParent" class="txtLinkPath roundedInput" readonly="readonly" /></div>
                <div>
                    <span>new parent </span><div onclick="$('#moveFolderDestDirTree').dialog('open');" class="toggleButton">...</div>
                    <div id="moveFolderDestDirTree" class="moveDirTreeContainer" title="Select Parent Folder"></div>
                    <input id="txtMoveFolderDest" class="roundedInput" readonly="readonly" />
                </div>
                <div class="roundendButton" onclick="moveFolder()">Move Folder</div>
            </div>

            <div id="copyFolderCrud" class="dashboardToggle" title="Copy Folder">
                <div><span>folder to copy</span><input id="txtNewStepParent" class="txtLinkPath roundedInput" readonly="readonly" /></div>
                <div><span>new name</span><input id="txtNewFolderName" class="roundedInput" /></div>
                <div><span>link</span><input id="xxxtxtNewLink" class="roundedInput" /></div>
                <div>
                    <span>new parent </span><div id="copyFolderToggleButton" onclick="$('#copyFolderParentDirTree').dialog('open');" class="toggleButton">...</div>
                    <div id="copyFolderParentDirTree" class="moveDirTreeContainer" title="Select Parent Folder"></div>
                    <input id="txtCopyFolderParent" class="roundedInput" readonly="readonly" />
                </div>
                <div class="roundendButton" onclick="copyFolder()">Copy Folder</div>
            </div>

            <div id="addEditRolesDialog" class="dashboardToggle" title="Add Edit Roles">
                <div class="crudArea">
                    <label>Role:</label>
                    <input class="roundedInput" id="txtRoleName" />
                    <div id="btnAddUpdateRole" class="roundendButton editRolebtn" onclick="addUpdateRole()">Add</div>
                    <div id="btnRoleToggle" class="roundendButton editRolebtn" onclick="toggleAddButton()">New</div>
                </div>
                <div class="crudItemsList" id="divRoleList"></div>
            </div>

            <div id="rolesChooseBoxDialog" class="dashboardToggle" title="Assign Roles">
                <div class="crudContainer AssignRolesContainer">
                    <div class="crudContainerTitle">Assign Roles</div>
                    <div class="flexContainer">
                        <div><select id="ddUsers" class="crudDropDown"></select></div>
                    </div>
                    <div id="divRolesChoose" class="chooseBoxContainer">

                        <div id="divChooseAvailable" class="chooseBox floatLeft"></div>

                        <div id="divChooseButtons" class="chooseBtnsContainer floatLeft">
                            <div><img id="imgAdd" class="chooseBtn" onclick="addUserRole()" src="/Images/sglright.jpg" /></div>
                            <div><img id="imgAddAll" class="chooseBtn disenabled" src="/Images/dblright.jpg" /></div>
                            <div><img id="imgRemove" class="chooseBtn" onclick="removeUserRole()" src="/Images/sglleft.jpg" /></div>
                            <div><img id="imgRemoveAll" class="chooseBtn disenabled" src="/Images/dblleft.jpg" /></div>
                        </div>
                        <div id="divChooseAssigned" class="chooseBox floatLeft"></div>
                    </div>
                </div>
            </div>

            <!--
                <div id="videoCrud" class="dashboardToggle">
                    <div class="floatingCrudBanner">Add Video Link <div onclick="$('#videoCrud').fadeOut()" class="farSide">x</div> </div>
                    <div class="floatingCrudContainer">
                        <div><span class="cru">link</span><input id="txtVideoLink" class="roundedInput" /></div>
                        <div><span>image</span><input id="txtVideoImage" class="roundedInput" /></div>
                        <div><span>title</span><input id="txtVideoTitle" class="roundedInput" /></div>
                        <div class="roundendButton" onclick="addVideo()">Insert</div>
                    </div>
                </div>
            -->
        </div>
    <div class="footer"></div>

    <script>
        $(document).ready(function () {
            $('.txtLinkPath').val('');
            setOggleHeader(3910, "dashboard");

            var dots = "";
            loadSettings();
            var getXMLsettingsWaiter = setInterval(function () {
                if (settingsArray.ApiServer === undefined) {
                    dots += "~ ";
                    $('dots').html(dots);
                }
                else {
                    clearInterval(getXMLsettingsWaiter);
                    checkFor404("start", "Dashboard");
                    var verifyConnectionWaiter = setInterval(function () {
                        if (connectionVerified) {
                            clearInterval(verifyConnectionWaiter);
                            $('dots').html("");
                            loadDirectoryTree(1, "dashboardRightColumn");
                            loadHeaderTabs();
                            resizeDashboardPage();
                            $('.dashboardContainerColumn').show();
                        }
                        else {
                            dots += ". ";
                            $('dots').html(dots);
                        }
                    }, 300);
                    //getpermissions
                    //if (isInRole("view dynamic"))
                    //logPageHit(3910, "dashboard");
                }
            }, 300);

            defineDilogs();
            //setSignalR();
            //resizeDashboardPage();
            //window.addEventListener("beforeunload", detectUnload());
            window.addEventListener("resize", resizeDashboardPage);
        });

        function resizeDashboardPage() {
            //resizePage();
            // HEIGHT

            let winH = $(window).height();
            let headerH = $('header').height();
            let screenH = winH - headerH;;
            $('.dashboardContainerColumn').height(screenH - 33);
            //$('.').css("min-height", screenH);
            //$('#dashboardLeftMenu').css("min-height", screenH);

            // WIDTH

            let middleColumnW = $('#dashboardContainer').width() - $('#dashboardRightColumn').width() - $('#dashboardLeftColumn').width();
            $('#dashboardMiddleColumn').width(middleColumnW - 21);
        }

        function loadHeaderTabs() {
            if (isInRole("add images")) {
                $('#breadcrumbContainer').append("<a class='activeBreadCrumb' href=\"javascript:setLeftMenu('Add Images');\">Add Images</a>");
                setLeftMenu('Add Images');
                $('#divAddImages').show();
            }
            if (isInRole("manage folders")) {
                $('#breadcrumbContainer').append("<a class='activeBreadCrumb' href=\"javascript:setLeftMenu('Manage Folders');\">Manage Folders</a>");
            }
            if (isInRole("Oggle admin")) {
                //alert("isInRole Oggle admin")
                $('#breadcrumbContainer').append("<a class='activeBreadCrumb' href=\"javascript:setLeftMenu('Admin');\">Admin</a>");
                $('#breadcrumbContainer').append("<a class='activeBreadCrumb' href=\"javascript:setLeftMenu('Reports');\">Reports</a>");
                $('#breadcrumbContainer').append("<a class='activeBreadCrumb' href=\"javascript:setLeftMenu('Manage Roles');\">Reports</a>");
                $('#headerMessage').html("Oggle admin");
                $('.adminLevelOption').show();
                setLeftMenu('Admin');
            }
        }

        function detectUnload() {
            alert("detectUnload");
        }

        function setSignalR() {

            var connection = $.hubConnection(service);

            var progressHubProxy = connection.createHubProxy('ProgressHub');

            progressHubProxy.on('PostToClient', function (data) {
                $('#dataifyInfo').html(data);
            });

            progressHubProxy.on('ShowProgressBar', function (goal, progress) {
                $('#progressBar').progressbar({ value: progress, max: goal });
            });


            connection.start({ jsonp: true })
                .done(function () {
                    console.log('Now connected, connection ID=' + connection.id);
                })
                .fail(function () {
                    alert('signalr Could not connect');
                    console.log('signalr Could not connect');
                });
        }

        function defineDilogs() {


            $('#renameFolderCrud').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                width: "400"
            });
            $('#createNewFolderDialog').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                width: "615"
            });
            $('#createNewFolderDialog').keydown(function (event) {
                if (event.keyCode === 13) {
                    createNewFolder();
                }
            });
            $('#createNewFolderDialog').on('dialogclose', function (event) {
                buildDirectoryTree();
                $('#createNewFolderDialog').hide();
            });


            $('#moveFolderCrud').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                width: "400"
            });

            $('#copyFolderCrud').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                width: "400"
            });

            $('#partialViewTreeContainer').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                position: ({ my: 'right', at: 'left', of: $('#moveFolderCrud') }),
                width: "400",
                height: "550"
            });

            $('#rolesChooseBoxDialog').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                width: "700"
            });

            $('#addEditRolesDialog').dialog({
                autoOpen: false,
                show: { effect: "fade" },
                hide: { effect: "blind" },
                width: "400"
            });
        }


    </script>
</body>
</html>
















