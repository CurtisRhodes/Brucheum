<!DOCTYPE html>
<html lang="en">
<head>
    <title>Welcome - OggleBooble</title>
    <link rel='shortcut icon' href='Images/favicon.png' type='image/x-icon' />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=.07">

    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.11.1/jquery-ui.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>
    <!--<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.1/themes/smoothness/jquery-ui.css" />-->
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.12/summernote.js"></script>-->
    <link href="Styles/jqueryUI.css" rel="stylesheet" />

    <script src="Scripts/Common.js"></script>
    <script src="Scripts/Permissions.js"></script>
    <script src="Scripts/HitCounter.js"></script>
    <script src="Scripts/EventControl.js"></script>
    <script src="Scripts/VerifyConnection.js"></script>
    <script src="Scripts/Cookies.js"></script>
    <script src="Scripts/Login.js"></script>

    <script src="Scripts/OggleHeader.js"></script>
    <script src="Scripts/OggleSearch.js"></script>
    <script src="Scripts/OggleFooter.js"></script>
    <script src="Scripts/OggleBlog.js"></script>
    <script src="Scripts/OggleRanker.js"></script>

    <script src="Scripts/Dashboard.js"></script>
    <script src="Scripts/DirTree.js"></script>
    <script src="Scripts/Roles.js"></script>
    <script src="Scripts/Reports.js"></script>
    <script src="Scripts/LinkManipulate.js"></script>

    <script src="Scripts/FolderInfoDialog.js"></script>
    <script src="Scripts/ImageCommentDialog.js"></script>
    <script src="Scripts/ContextMenu.js"></script>
    <script src="Scripts/Carousel.js"></script>
    <script src="Scripts/IndexPage.js"></script>

    <link href="Styles/Common.css" rel="stylesheet" />
    <link href="Styles/AlbumPage.css" rel="stylesheet">
    <link href="Styles/loginDialog.css" rel="stylesheet" />
    <link href="Styles/OggleHeader.css" rel="stylesheet" />
    <link href="Styles/ContextMenu.css" rel="stylesheet" />
    <link href="Styles/Slideshow.css" rel="stylesheet" />
    <link href="Styles/MoveCopyArchiveDialog.css" rel="stylesheet" />
    <link href="Styles/ModelInfoDialog.css" rel="stylesheet" />
    <link href="Styles/ImageCommentDialog.css" rel="stylesheet" />
    <link href="Styles/MetaTagDialog.css" rel="stylesheet" />
    <link href="Styles/FolderCategoryDialog.css" rel="stylesheet" />

    <link href="Styles/IndexPage.css" rel="stylesheet">
    <link href="Styles/Carousel.css" rel="stylesheet">
    <link href="Styles/OggleBlog.css" rel="stylesheet" />


    <link href="Styles/Dashboard.css" rel="stylesheet" />
    <link href="Styles/ChooseBox.css" rel="stylesheet" />

</head>
<body>
    <div id="oggleHeader" class="stickyHeader boobsHeader"></div>
    <div class="threeColumnLayout">
        <div class="leftColumn">
            <div id="pabh" class="promoBox"></div>
        </div>
        <div class="middleColumn">
            <div id="divStatusMessage"></div>
            <div id="dots">DDDDDDDDDD</div>
            <img id="boobsRankerLoadingGif" class="loadingGif" src="Images/loader.gif" />
            <div id="indexMiddleColumn"></div>
        </div>
        <div class="rightColumn"></div>
    </div>
    <div class="footer"></div>

    <script>
        let spaPageId, dots = "",
            promoIdx, promoMessagesArray = new Array(),
            promoMessageRotator, promoMessageRotationSpeed = 15000,
            updatedGalleriesCount = 25;

        $(document).ready(function () {
            //$('#footerLastBuild').html("last build: " + lastBuild + "3");
            //$('#footerMessage').html("loading settings");

            document.title = "loading settings : OggleBooble";
            loadOggleSettings();

            params = getParams();
            if (params.subdomain === undefined)
                subdomain = "index";

            if (isNullorUndefined(params.spa))
                spaPageId = 3908;
            else
                spaPageId = params.spa;


            setOggleHeader(spaPageId, "loading");
           
            var getXMLsettingsWaiter = setInterval(function () {
                if (settingsArray.ApiServer === undefined) {
                    dots += "~ ";
                    $('#dots').html(dots);
                    //console.log("loadSettings: " + settingsArray.ApiServer);
                }
                else {
                    clearInterval(getXMLsettingsWaiter);
                    //  LOCAL HOST because cookies don't work in IIS
                    if (document.domain === 'localhost') {
                        setCookieValue("VisitorId", "ec6fb880-ddc2-4375-8237-021732907510");
                        setCookieValue("UserName", "developer");
                        var userPermissons = [];
                        userPermissons.push("Oggle admin");
                        userPermissons.push("access dashboard");
                        userPermissons.push("view dynamic");
                        window.localStorage["userPermissons"] = userPermissons;
                        //window.localStorage["IsLoggedIn"] = "true";
                    }

                    checkFor404("start");
                    var verifyConnectionWaiter = setInterval(function () {
                        if (connectionVerified) {
                            clearInterval(verifyConnectionWaiter);
                            $('#dots').html('');

                            //logError({
                            //    VisitorId: "unknown",
                            //    ActivityCode: "017",
                            //    Severity: 1,
                            //    ErrorMessage: "cookieFail userName",
                            //    CalledFrom: "isInRole()"
                            //});

                            var visitorId = getCookieValue("VisitorId");
                            if (isNullorUndefined(visitorId)) {


                                getIpInfo(spaPageId);


                                loadRolesIntoLocalStorage("index", "any");
                            }
                            else {
                                console.log("visitorId found: " + visitorId);
                            }

                            // ranker     homePageId = 3907;
                            // boobs      homePageId = 3908;
                            // porn       homePageId = 3909;
                            // dashboard  homePageId = 3910;
                            // blog       homePageId = 3911;
                            if (spaPageId == 3907) { // ranker
                                $('#indexMiddleColumn').html(rankerHTML());
                                rankerStartup(params.bp);
                            }
                            if (spaPageId == 3908 || spaPageId === 3909) {  // boobs,porn
                                indexStartup(spaPageId);
                            }
                            if (spaPageId == 3910) {  // dashboard
                                dashboardStartup();
                            }
                            if (spaPageId == 3911) { // "blog"
                                $('#indexMiddleColumn').html(blogBodyHtml());
                                blogStartup();
                            }
                        }
                        else {
                            dots += ". ";
                            $('#dots').html(dots);
                        }
                    }, 600);
                }
            }, 300);

            window.addEventListener("resize", resizePage());
            window.addEventListener("resize", resizeIndexPage);
            resizeIndexPage();
        });

        function resizeIndexPage() {
            // height
            var winH = $(window).height();
            var headerH = $('header').height() + 50;
            $('#topIndexPageSection').height((winH - headerH - 100));
            $('#topIndexPageSection').height((winH - headerH) * .65);
            // width

            var winW = $(window).width();
            $('section').css("background-color", "#d5d1ba");
            if (winW < 1500) {
                $('section').css("background-color", "red");
            }
        }
    </script>
</body>
</html>
